# Using wallet to interact with coschain

## What can learn from

1. Account
    1. Account list and detail
    2. Import an account from a private key
    3. Create an account
    4. Generate mnemonic then create an account
    5. Import/lock/unlock local accounts
2. Currency
    1. Transfer
    2. Vest
    3. Stake
3. Content
    1. Post
    2. Reply
    3. Vote

### Tips

All commands below is execuated in interactive mode and wallet has been connected with local coschain.
All commands can pass flag **--help** to know how to use

## Account

There is two type of account in coschain. One is called local account, the other is called chain account.

### Local account

Local account is a keystore file, located in `~/.coschain`. A keystore file is a json format file contains a encrypted private key and a public key. Keystore file can be created/imported through wallet-cli.

A keystore file looks like:

```json
{  
   "Name":"testuser",
   "PubKey":"COS745h9zeER6qea8q9GVnRVvia7dHXnbPSAKvF84SbwSdzBG5pa1",
   "Cipher":"AES-256",
   "CipherText":"Bo3DR/lPtrfau4CsgHBFR4jPE78fPUnY5xY9pO6OKhuMe5fTZ2jxPd8MJDzcqiFSf7o=",
   "Iv":"Bj8mdb0z8JAFrAdvNSl+Sw==",
   "Mac":"sgZbYnWPF26v4cWbhIA6BhMKOxvEVPm/NwEpcViHkYE=",
   "Version":1
}
```

Name refers to a coschain account name.

### Coschain account

If an account were created, its information could be queried from chain include balance, vest etc.

### Local Account List

**List local accounts**

```shell
./wallet-cli
> list
```

**Result**

```shell
> list
account: initminer15 | status:   locked
account:  initminer2 | status:   locked
account:  initminer5 | status:   locked
account: initminer11 | status:   locked
account: initminer16 | status:   locked
```

**Look through account key pair**

```shell
./wallet-cli
> info initminer10
```

**Result**

```shell
> info initminer10
account: initminer10
pub_key: COS8fV44EgGUWjEKddPbfrXAaqYxYes4M99KLHYBwrXEj3hWP4XPr
priv_key: 4UKbH7TDr6FgFXNjzQdX3ucAXndzY4h7YBNNgnqjtUeLJkFXVg
status: unlocked
```

**Look through account info in coschain**

```shell
./wallet-cli
> account get initminer
```

**Result**

```shell
> account get initminer
GetAccountByName detail: {
	"info": {
		"account_name": "initminer",
		"coin": "6499969988.999988 COS",
		"vest": "0.000000 VEST",
		"public_key": "COS5JVLLcTPhq4Unr194JzWPDNSYGoMcam8yxnsjgRVo3Nb7ioyFW",
		"created_time": "1970/1/1 00:00:00",
		"trx_count": 19,
		"vote_power": 1000,
		"stamina_free_remain": 95304,
		"stamina_stake_remain": 864000000000,
		"stamina_max": 864000100000,
		"stake_vest_for_me": "11.000000 VEST",
		"withdraw_remains": "0.000000 VEST",
		"withdraw_each_time": "0.000000 VEST",
		"next_withdraw_time": "1970/1/1 00:00:00",
		"bp_vote_count": 1,
        ...
```

### Import account through private key

If knew a chain account with a private key, but there were not a keystore file in local. `import` command is required to import private key and generate keystore file. It usually occurs switching into a new device.

```shell
./wallet-cli
> import initminer 4DjYx2KAGh1NP3dai7MZTLUBMMhMBPmwouKE8jhVSESywccpVZ
```

In local environment, initminer's private key is *4DjYx2KAGh1NP3dai7MZTLUBMMhMBPmwouKE8jhVSESywccpVZ*, you can import it through above command.

### Create account through wallet.

Similar with EOS, user cannot create account by themself but have to be created by others who already has a coschain's account.

In local environment, initminer has enough COS to create an account

```shell
./wallet-cli
> create initminer testuser1
```

the command will remind to input a passphrase which is used to encrypt private key. Use a strong passphrase and keep keystore in safe place.

Coschain restricts account name's length from 6 to 16 and lower letters.

Executing `create` command will create a coschain account and create a keystore file in local. The key-pair is generated by random, using `info` to look through.

### Generate mnemonic then create account from it.

Contentos implements standard [BIP39](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki) protocol which allows you to generate key-pair from mnemonic.

Step 1 generate mnemonic.

```shell
./wallet-cli
> genKeyPair
Mnemonic: donate shaft leisure fashion basic oyster knock saddle broken prevent junior entire cake slice payment always direct system forum require smile bus follow expire
Public  Key:  COS7hGNoSNyAwUZ3kgkjFa4RCmsjcuZNxS2q2mfhMMML6CYZ5Dtqs
Private Key:  3PMfB7RY5irkcKTzRtWje3G4mhKRiGHYrriKDxyshxNdN4eAkN
```

the mnemonic *donate shaft leisure fashion basic oyster knock saddle broken prevent junior entire cake slice payment always direct system forum require smile bus follow expire* could map into the key-pair.

Then create account from

```shell
./wallet-cli
> create_from_mnemonic initminer testuser2
```

### Import/Lock/Unlock local accounts

Local account could be lock state or unlock state. When an account locaked, its private key is encrypted so could not be used to sign transaction. It should be unlocked first.

```shell
./wallet-cli
> unlock initminer
```

Input the passphrase to unlock.

You can also `lock` an account.

When coschain started, it would import all keystore files under `~/.coschain`, you can `load` keystore file which located in different path. All loaded account is locked.

If a unlocked account had no operation for a short while, it automatically locked itself.

## Currency

The Currency in coschain is called COS, VEST and STAKE are different types of COS. COS can be convert to VEST and vice verse, also COS to STAKE. But VEST has no way to convert to STAKE and vice verse.

User can transfer COS to others but VEST and STAKE is immovable. VEST refers one's power in coschain and STAKE is used to acquire stamina --- each operation execuated in coschain would spent stamina.

### Transfer

```shell
./wallet-cli
> transfer initminer testuser0 1.000000
```

* Precision of COS is 6 digits
* Sender should be different from receiver
* Sender should be unlocked

**Result**

```shell
> transfer initminer runetressa 1.000000
Result: invoice:<status:200 net_usage:1250 cpu_usage:1 op_results:<> >
```

### Vest

```shell
./wallet-cli
> transfer_vest initminer testuser0 1.000000 'memo'
```

* It convert COS to VEST
* Sender can be same with receiver
* Exchange rate COS to Vest is fixed to 1
* Memo can be empty

**Result**

```shell
> transfer_vest initminer initminer 1.000000
Result: invoice:<status:200 net_usage:1240 cpu_usage:1 op_results:<> >
```

### Stake

Execuate any operation on coschain will spend stamina. For a user, the number of operations can be sent to coschain is determined by user's current stamina.

Stamina has two sources to acquire, one is called free quota. Coschain gives each account some stamina every day so a new account can execute few operations.

If free quota is not enough, user can stake to acquire it. More cos is staked, more stamina the account would get.

Stamina automatically recovers, and after 1 day, it will be full.

```shell
./wallet-cli
> stake initminer testuser0 1.000000
```

Like transfer_vest, stake allows sender and receiver same.

## Content

As a contento chain, user can get reward by post/reply a content or vote for it.

Author would not be awarded from he/she's content unless others vote for it. The reward is determined by total votes weighted power.

### Post

```shell
./wallet-cli
> post initminer "article" "hello world" "hello world for everyone"
```

**Result**

```shell
> post initminer "article" "hello world" "hello world for everyone"
Result: invoice:<status:200 net_usage:1630 cpu_usage:1 op_results:<> >
```

### Reply

```shell
./wallet-cli
> reply "intminer" "content" 1571218688384377456
Result: invoice:<status:200 net_usage:1630 cpu_usage:1 op_results:<> >
```

1571218688384377456 refers to a post id in coschain, also, it can be a reply id. After all, reply is a type of post.

### Vote

```shell
./wallet-cli
> vote "initminer" 1571218688384377456
Result: invoice:<status:200 net_usage:1630 cpu_usage:1 op_results:<> >
```

Same, 1571218688384377456 refers to a post id or a reply id.
